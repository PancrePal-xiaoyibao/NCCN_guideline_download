# NCCN下载爬虫脚本开发计划

## 项目概述

基于现有代码优化，构建一个菜单式NCCN指南下载工具，支持多主题分类下载、安全请求控制、完善日志和重新下载功能。

## 核心功能需求

### 1. 菜单系统设计
- 交互式主菜单，支持主题选择
- 认证方式选择（用户名/密码 或 Cookie）
- 配置参数设置

### 2. 多主题下载支持
- **主题1**: 癌症治疗指南 (Treatment by Cancer Type) - category_1
- **主题2**: 支持性护理 (Supportive Care) - category_3
- **主题3**: 患者指南 (Patient Guidelines) - patientresources
- **主题4**: 临床指南中文翻译 (Clinical Translations)
- **主题5**: 患者指南中文翻译 (Patient Guidelines Translations)

### 3. 目录结构管理
```
nccn_downloads/
├── 01_Cancer_Treatment/
├── 02_Supportive_Care/
├── 03_Patient_Guidelines/
├── 04_Clinical_Translations/
├── 05_Patient_Translations/
└── logs/
```

### 4. 安全特性
- 请求间隔控制 (2-5秒随机延迟)
- 错误重试机制 (最多3次)
- 文件完整性验证
- 会话状态管理

### 5. 日志和统计
- 详细操作日志
- 下载统计报告
- 失败文件清单
- 自动重新下载机制

## 开发步骤

### 第一阶段：架构设计和菜单系统
- [ ] 创建主程序入口和菜单界面
- [ ] 设计主题选择逻辑
- [ ] 实现认证方式选择
- [ ] 配置管理系统

### 第二阶段：核心下载引擎
- [ ] 优化NCCNDownloader类
- [ ] 实现主题特定的解析逻辑
- [ ] 添加目录自动创建功能
- [ ] 实现增量下载机制

### 第三阶段：安全性和稳定性
- [ ] 添加请求频率控制
- [ ] 实现重试和错误处理
- [ ] 添加文件验证功能
- [ ] 完善会话管理

### 第四阶段：日志和用户反馈
- [ ] 完善日志系统
- [ ] 实现统计功能
- [ ] 添加进度显示
- [ ] 创建失败重试界面

### 第五阶段：测试和优化
- [ ] 测试各主题下载功能
- [ ] 优化性能和稳定性
- [ ] 添加使用说明
- [ ] 错误处理完善

## 技术改进点

### 相比原脚本的优化：
1. **菜单化操作**：替代硬编码URL
2. **主题分类**：自动目录管理和分类下载
3. **双重认证**：用户名密码 + Cookie支持
4. **智能重试**：失败文件自动重新下载
5. **完善日志**：详细统计和错误追踪
6. **安全控制**：请求频率和错误处理
7. **用户体验**：进度显示和状态反馈

## 预期交付物

1. **download_NCCN_Guide_v2_menu.py** - 主程序文件
2. **config.json** - 配置文件模板
3. **README.md** - 使用说明文档
4. **changelog.md** - 版本更新日志

## 开发时间估算

- 总计：4-6小时
- 第一阶段：1小时
- 第二阶段：1.5小时
- 第三阶段：1.5小时
- 第四阶段：1小时
- 第五阶段：1小时

请确认此开发计划是否符合您的需求？如需调整请告知，确认后我将开始实施开发。